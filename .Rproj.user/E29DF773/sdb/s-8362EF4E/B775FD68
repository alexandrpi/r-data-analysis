{
    "collab_server" : "",
    "contents" : "setwd(\"C:\\\\Users\\\\user\\\\Desktop\\\\rwd\")\noptions(scipen=5)\n\nfire_data <- read.csv(\"Fire_incidents.csv\")\ntime.format <- \"%m/%d/%Y %I:%M:%S %p\"\n\n# попробуем узнать, есть ли линейная зависимость между\n# величиной ущерба от пожара и днем, когда случился пожар\nfire.day.to.loss <- fire_data[c(1,5)]\nlength(fire.loss[,1])\nfire.day.to.loss[,1] <- as.factor(weekdays(as.Date(fire.day.to.loss[,1], format=\"%m/%d/%Y\"), abbreviate=TRUE))\nlevels(fire.day.to.loss[,1]) <- list(Пн=1, Вт=2, Ср=3, Чт=4, Пт=5, Сб=6, Вс=7)\n\nfire.day.to.loss[,1] <- as.numeric(fire.day.to.loss[,1])\nplot(fire.day.to.loss[,1], fire.day.to.loss[,2], col=\"blue\", type=\"p\", pch=16, main=\"Зависимость ущерба, причиненного пожаром, от дня недели\")\n\n# есть ли линейная зависимость между продолжительностью тушения пожара\n# и величиной ущерба от него\nfire.time.to.loss <- fire_data[5]\nfire.time.to.loss[,2] <- mapply(function(start, end) difftime(strptime(end, format=time.format), strptime(start, format=time.format), units=\"mins\"), fire_data[,3], fire_data[,4])\ncolnames(fire.time.to.loss) <- c(\"Loss\", \"Time\")\nplot(fire.time.to.loss[, 2], fire.time.to.loss[, 1],\n     col=\"#FF3D00\", type=\"p\",\n     pch=16,\n     main=\"Зависимость ущерба, причиненного пожаром, от продолжительности его тушения в Сан-Франциско\",\n     xlab=\"Продолжительность тушения пожара (мин)\",\n     ylab=\"Причиненный ущерб ($ США)\")\n\n\nfire_floor_data <- read.csv(\"fire.floors.csv\")\n\n# есть ли линейная зависимость между этажом, на котором начался пожар\n# и продолжительностью его тушения\nfire.floor.to.time <- fire_floor_data[7]\nfire.floor.to.time[,2] <- mapply(function(start, end) difftime(strptime(end, format=time.format), strptime(start, format=time.format), units=\"mins\"), fire_floor_data[,3], fire_floor_data[,4])\nplot(fire.floor.to.time[,1], fire.floor.to.time[,2],\n     col=\"#FF3D00\", type=\"p\",\n     pch=16,\n     main=\"Зависимость продолжительности тушения пожара от этажа его возгорания в Сан-Франциско\",\n     xlab=\"Этаж возгорания\",\n     ylab=\"Продолжительность тушения пожара (мин)\")\n\n# есть ли линейная зависимость между временем реагирования пожарных\n# и продолжительностью его тушения\nfire.reaction.to.time <- data.frame()\nfire.reaction.to.time <- mapply(function(start, end) difftime(strptime(end, format=time.format), strptime(start, format=time.format), units=\"mins\"), fire_floor_data[,2], fire_floor_data[,3])\nfire.reaction.to.time <- data.frame(fire.reaction.to.time)\nfire.reaction.to.time[,2] <- mapply(function(start, end) difftime(strptime(end, format=time.format), strptime(start, format=time.format), units=\"mins\"), fire_floor_data[,3], fire_floor_data[,4])\nfire.reaction.to.time <- na.omit(fire.reaction.to.time)\nsummary(fire.reaction.to.time)\nplot(fire.reaction.to.time[,1], fire.reaction.to.time[,2],\n     col=\"#FF3D00\", type=\"p\",\n     pch=16,\n     main=\"Зависимость продолжительности тушения пожара от времени реагирования пожарных в Сан-Франциско\",\n     xlab=\"Время реагирования (мин)\",\n     ylab=\"Продолжительность тушения пожара (мин)\")\n\n\n# есть ли линейная зависимость между этажом, на котором начался пожар\n# и продолжительностью его тушения\nremove(fire.floor.to.loss)\nfire.floor.to.loss <- fire_floor_data[7]\nfire.floor.to.loss[,2] <- fire_floor_data[6]\nfire.floor.to.loss\nfire.floor.to.loss <- na.omit(fire.floor.to.loss)\nna.fail(fire.floor.to.loss)\ncolnames(fire.floor.to.loss) <- c(\"Floor\", \"Loss\")\nfire.floor.to.loss <- subset(fire.floor.to.loss, Floor < 25, Loss < 100000)\nplot(fire.floor.to.loss[,1], fire.floor.to.loss[,2],\n     col=\"#FF3D00\", type=\"p\",\n     pch=16,\n     main=\"Зависимость ущерба, причиненного пожаром, от этажа его возгорания в Сан-Франциско\",\n     xlab=\"Этаж возгорания\",\n     ylab=\"Причиненный ущерб ($ США)\")",
    "created" : 1475093079904.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2236627427",
    "id" : "B775FD68",
    "lastKnownWriteTime" : 1475693743,
    "last_content_update" : 1475693743855,
    "path" : "C:/Users/user/Desktop/rwd/R3.R",
    "project_path" : "R3.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}