sep=";")
data <- na.omit(subset(data, duration < 20000))
duration <- data[,1] / 3600
max_temp <- data[,4]
plot(max_temp, duration, col="#2C666E", type="p",
xlab="X",
ylab="Y")
View(data)
View(data)
data <- read.table("output_group_by.csv",
header=TRUE,
sep=";")
na.fail(data)
data <- na.omit(data)
options(scipen=5)
count <- data[,23]
mean_temp <- data[,3]
plot(mean_temp, count, col="#2C666E", type="p",
xlab="X",
ylab="Y")
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,1]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,2]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,18]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,6]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,22]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,9]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,21]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,22]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,20]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
mean_temp <- data[,19]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
cor(data)
data <- na.omit(data[,2:23])
cor(data)
data <- na.omit(data[,c(1:18, 20:22])
data <- na.omit(data[,c(1:18, 20:22)])
cor(data)
data <- read.table("FINALDATA.csv",
header=TRUE,
sep=";")
na.fail(data)
data <- na.omit(data)
cor(data)
data <- na.omit(data[, c(1, 4:21, 23, 24)])
cor(data)
cor(data)
data <- read.table("output_gruop_by.csv",
data <- read.table("output_gruop_by.csv",
header=TRUE,
sep=";")
na.fail(data)
data <- read.table("output_gruop_by.csv",
header=TRUE,
sep=";")
data <- read.table("output_group_by.csv",
header=TRUE,
sep=";")
data <- na.omit(data[,c(2:19, 21:23)])
count <- data[,21]
mean_temp <- data[,2]
data <- read.table("output_group_by.csv",
header=TRUE,
sep=";")
data <- na.omit(data[,c(2:19, 21:23)])
data <- scale(data)
View(data)
count <- data[,21]
mean_temp <- data[,2]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
data <- read.table("output_data.csv",
header=TRUE,
sep=";")
View(data)
na.fail(data)
data <- na.omit(data)
data.cust <- data[subscription_type="Customer"]
data.cust <- data$subscription_type="Customer"
data.cust <- data$subscription_type="Customer"
data.cust <- subset(data, subscription_type="Customer")
data.cust <- subset(data, subscription_type=="Customer")
data.cust <- subset(data, subscription_type=="Subscriber")
data.cust <- subset(data, subscription_type=="Customer")
data.sub <- subset(data, subscription_type=="Subscriber")
count <- data.cust[,1]
mean_temp <- data.cust[,6]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
options(scipen=5)
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
cor(data.cust)
cor(data.cust[, c(1, 5:22, 24, 25)])
cor(data.sub[, c(1, 5:22, 24, 25)])
count <- data.cust[,1] / 60
mean_temp <- data.cust[,6]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
count <- data.sub[,1] / 60
mean_temp <- data.sub[,6]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
data <- read.table("count_all.csv",
header=TRUE,
sep=",")
data <- read.table("count_all.csv",
header=TRUE,
sep=";")
data <- na.omit(data)
options(scipen=5)
cor(data)
cor(data[c(2:19, 21:23)])
data <- read.table("count_cust.csv",
header=TRUE,
sep=";")
data <- na.omit(data)
cor(data[c(2:19, 21:23)])
count <- data.sub[,23]
mean_temp <- data.sub[,3]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
count <- data[,23]
mean_temp <- data[,3]
plot(mean_temp, count, col="#2C666E", type="p",
pch=16,
xlab="X",
ylab="Y")
data <- read.table("count_sub.csv",
header=TRUE,
sep=";")
data <- na.omit(data)
cor(data[c(2:19, 21:23)])
data <- read.table("DATA_ALL.csv",
header=TRUE,
sep=";")
data <- read.table("DATA_ALL.csv",
header=TRUE,
sep=";")
cor(data[c(2:19, 21:23)])
data <- na.omit(data)
cor(data[c(2:19, 21:23)])
data.summer <- subset(data, grepl("[6-8]/\d+/\d+",date))[c(2:19, 21:23)]
data.summer <- subset(data, grepl("[6-8]/\d+/\d+", date, perl=TRUE))[c(2:19, 21:23)]
data.summer <- subset(data, grepl("[6-8]/\\d+/\\d+", date))[c(2:19, 21:23)]
data.summer <- subset(data, grepl("[6-8]/\\d+/\\d+", date))
data.summer <- subset(data, grepl("[6-8]/\\d+/\\d+", date))
View(data.summer)
View(data.summer)
data.summer <- subset(data, grepl("[6-8]/\\d+/\\d+", date))[c(2:19, 21:23)]
cor(data.summer)
data.summer <- subset(data, grepl("(1|2|12)/\\d+/\\d+", date))[c(2:19, 21:23)]
cor(data.summer)
data.summer <- subset(data, grepl("[6-8]/\\d+/\\d+", date), duration < 1800)[c(2:19, 21:23)]
cor(data.summer)
data.summer <- subset(data, grepl("(1|2|12)/\\d+/\\d+", date), duration < 1800)[c(2:19, 21:23)]
cor(data.summer)
data.summer <- subset(data, grepl("(1|2|12)/\\d+/\\d+", date) & duration < 1800)[c(2:19, 21:23)]
cor(data.summer)
data.summer <- subset(data, grepl("[0-9]/\\d+/\\d+", date) & duration < 1800)[c(2:19, 21:23)]
data.summer <- subset(data, grepl("[6-8]/\\d+/\\d+", date) & duration < 1800)[c(2:19, 21:23)]
cor(data.summer)
data.summer <- subset(data, grepl("[6-8]/\\d+/\\d+", date) & duration < 1800 & susbcription_type=="Customer")[c(2:19, 21:23)]
data.summer <- subset(data,
grepl("[6-8]/\\d+/\\d+", date)
& duration < 1800
& subscription_type=="Customer")
cor(data.summer[c(2:19, 21:23)])
data.summer <- subset(data,
grepl("[6-8]/\\d+/\\d+", date)
& duration > 1800
& subscription_type=="Customer")
cor(data.summer[c(2:19, 21:23)])
data.summer <- subset(data,
grepl("[6-8]/\\d+/\\d+", date)
& duration > 1800
& subscription_type=="Subscriber")
cor(data.summer[c(2:19, 21:23)])
data.summer <- subset(data,
# grepl("[6-8]/\\d+/\\d+", date)
duration > 1800
& subscription_type=="Subscriber")
cor(data.summer[c(2:19, 21:23)])
data.summer <- subset(data,
# grepl("[6-8]/\\d+/\\d+", date)
duration > 1800
& subscription_type=="Customer")
cor(data.summer[c(2:19, 21:23)])
data.summer <- subset(data,
# grepl("[6-8]/\\d+/\\d+", date)
duration < 1800
& subscription_type=="Customer")
cor(data.summer[c(2:19, 21:23)])
data.summer <- subset(data,
# grepl("[6-8]/\\d+/\\d+", date)
duration > 1800
& subscription_type=="Customer")
cor(data.summer[c(2:19, 21:23)])
data <- read.table("cust_cnt_more_1800.csv",
header=TRUE,
sep=";")
cor(data[c(2:22)])
data <- na.omit(data)
cor(data[c(2:22)])
data.summer <- subset(data,
grepl("[6-8]/\\d+/\\d+", date))
cor(data.summer[c(2:22)])
data <- read.table("sub_more_1800_cnt.csv",
header=TRUE,
sep=";")
data <- na.omit(data)
cor(data[c(2:22)])
data <- read.table("cust_less_1800_cnt.csv",
header=TRUE,
sep=";")
data <- na.omit(data)
cor(data[c(2:22)])
remove(duration, data.cust, data.summer, data.sub, max_temp)
data <- read.table("cust_less_1800_cnt_wkds.txt",
header=TRUE,
sep=";")
data <- na.omit(data)
options(scipen=5)
cor(data[c(2:22)])
plot(mean_temp, count, col="#0B3954", type="p",
pch=16,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
regression <- lm(formula=count ~ mean_temp)
regression
summary(regression)
abline(regression, col="#C81D25", lwd="3")
plot(mean_temp, count, col="#0B3954", type="p",
pch=16,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
regression <- lm(formula=count ~ mean_temp)
regression
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="yellow",
pch=17,
add=TRUE)
prognosis.temps <-c(53, 71, 64, 78, 46)
prognosis.counts <- predict(regression, data.frame(mean_temp=prognosis.temps), level=0.9, interval="confidence")
points(prognosis.temps,
prognosis.counts[,1],
col="yellow",
pch=17,
add=TRUE)
plot(mean_temp, count, col="#0B3954", type="p",
pch=16,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#087E8B",
pch=17,
add=TRUE)
plot(mean_temp, count, col="#0B3954", type="p",
pch=16,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
pch=17,
add=TRUE)
F49D37
plot(mean_temp, count, col="#0B3954", type="p",
pch=16,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#3F88C5",
pch=17,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
pch=17,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
pch=1,
add=TRUE)
plot(mean_temp, count, col="#0B3954", type="p",
pch=16,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
pch=1,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
# col="#F49D37",
col="black",
pch=1,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
# col="black",
pch=2,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
# col="black",
pch=9,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
# col="black",
pch=21,
add=TRUE)
plot(mean_temp, count, col="#0B3954", type="p",
pch=16,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
# col="black",
pch=21,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
# col="black",
pch=19,
add=TRUE)
plot(mean_temp, count, col="#0B3954", type="p",
pch=20,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
# col="black",
pch=19,
add=TRUE)
plot(mean_temp, count, col="#0B3954", type="p",
pch=20,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
bg="#F49D37",
col="black",
pch=21,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
bg="white",
col="#F49D37",
pch=21,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
pch=17,
add=TRUE)
plot(mean_temp, count, col="#0B3954", type="p",
pch=20,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#F49D37",
pch=17,
add=TRUE)
plot(mean_temp, count, col="#0B3954", type="p",
pch=20,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="green",
pch=17,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#B8B42D",
pch=17,
add=TRUE)
points(prognosis.temps,
prognosis.counts[,1],
col="#697A21",
pch=17,
add=TRUE)
plot(mean_temp, count, col="#B8B42D", type="p",
pch=20,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок",
bg="#BFD7EA")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#3E363F",
pch=17,
add=TRUE)
plot(mean_temp, count, col="#B8B42D", type="p",
pch=20,
xlab="Средняя температура воздуха, F",
ylab="Количество поездок")
abline(regression, col="#C81D25", lwd="3")
points(prognosis.temps,
prognosis.counts[,1],
col="#3E363F",
pch=17,
add=TRUE)
